{% extends 'main/base.html' %}
{% load static %}
{% block title %}خطط ال{% endblock %}
{% block style %}
<style>
    body {

        background: radial-gradient(circle at top left, var(--orange-1) 0, transparent 55%),
            radial-gradient(circle at bottom right, var(--orange-3) 0, transparent 55%),
            var(--gray-dark-1);

    }
</style>
{% endblock %}
{% block content %}
<section class="pricing-section py-5">
    <div class="container">
        <h2 class="text-center mb-5 pricing-title">خطط الاشتراك </h2>

        <div class="row g-4 justify-content-center">

            <!-- الكرت الأول (الأكثر شعبية) -->
            {% for plan in plans %}
            <div class="col-md-4">
                <div class="pricing-card popular h-100">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h3 class="plan-name mb-0">
                        {{ plan.name }} 
                        </h3>

                        <span class="badge-popular">                            خطة الـ
                            {% if plan.duration_days >= 365 %}
                            سنة
                            {% elif plan.duration_days >= 30 %}
                            شهر
                            {% else %}
                            {{ plan.duration_days }} يوم
                            {% endif %}</span>


                    </div>
                    <p class="plan-desc">
                         {{ plan.description }}  
                    </p>

                    <div class="price mb-2">{{ plan.price }} ريال<span class="price-period">/{% if plan.duration_days >= 365 %}
                            سنة
                            {% elif plan.duration_days >= 30 %}
                            شهر
                            {% else %}
                            {{ plan.duration_days }} يوم
                            {% endif %}</span></div>
                    <p class="small text-muted mb-4" style="color: black !important;">{{plan.remaining}}/{{plan.max_subscribers}} سارعي بالاشتراك</p>


                        <span class="d-flex gap-3 mt-4 mb-4">
                            {% if request.user == coach.user or request.user.is_staff %}
                            <!-- زر التعديل -->
                            <a href="{% url 'coaches:update_plan_view' coach.id %}" class="btn btn-warning btn-plan w-100" >
                                تعديل
                            </a>

                            <!-- زر الحذف -->
                            <a href="{% url 'coaches:delete_plan_view' coach.id %}" class="btn btn-danger btn-plan del w-100" 
                                onclick="return confirm('هل تردين حذف الخطة؟');">
                                حذف
                            </a>
                            {% endif %}
                        </span>
                    {% if plan.remaining > 0 %}
                    <a href="" class="btn btn-cta w-100">اشترك الان</a>
                    {% else %}
                    <button class="btn btn-light w-100" disabled>مغلق</button>
                    {% endif %}

                </div>
            </div>
            {% endfor %}


        </div>
    </div>
</section>

{% endblock %}